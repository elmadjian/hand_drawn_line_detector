
float MaxRadiusByErosion(Image *bin){
  Image *bin1=NULL,*edt=NULL;
  AdjRel *A=NULL;
  int Imax,Emax;

  A = Circular(1.0);
  bin1 = Threshold(bin, 0, 0);
  edt = Mask2EDT(bin1, A, INTERIOR, INT_MAX, 0);
  Emax = MaximumValue(edt);
  DestroyImage(&bin1);
  DestroyImage(&edt);

  bin1 = Threshold(bin, 1, INT_MAX);
  edt = Mask2EDT(bin1, A, INTERIOR, INT_MAX, 0);
  Imax = MaximumValue(edt);
  DestroyImage(&bin1);
  DestroyImage(&edt);
  DestroyAdjRel(&A);

  return MIN(sqrtf(Imax),sqrtf(Emax));
}


float MaxObjRadiusByErosion(Image *bin){
  Image *bin1=NULL,*edt=NULL;
  AdjRel *A=NULL;
  int Imax;

  A = Circular(1.0);
  bin1 = Threshold(bin, 1, INT_MAX);
  edt = Mask2EDT(bin1, A, INTERIOR, INT_MAX, 0);
  Imax = MaximumValue(edt);
  DestroyImage(&bin1);
  DestroyImage(&edt);
  DestroyAdjRel(&A);

  return (sqrtf(Imax));
}


float MaxBkgRadiusByErosion(Image *bin){
  Image *bin1=NULL,*edt=NULL;
  AdjRel *A=NULL;
  int Emax;

  A = Circular(1.0);
  bin1 = Threshold(bin, 0, 0);
  edt = Mask2EDT(bin1, A, INTERIOR, INT_MAX, 0);
  Emax = MaximumValue(edt);
  DestroyImage(&bin1);
  DestroyImage(&edt);
  DestroyAdjRel(&A);

  return (sqrtf(Emax));
}



Image *BkgMaskByErosion(Image *bin, float radius){
  Set *S=NULL;
  Image *bin1=NULL,*bin2=NULL;

  bin1 = Threshold(bin, 0, 0);
  bin2 = ErodeBin(bin1, &S, radius);
  DestroyImage(&bin1);
  DestroySet(&S);
  return bin2;
}


Image *ObjMaskByErosion(Image *bin, float radius){
  Set *S=NULL;
  Image *bin1=NULL,*bin2=NULL;

  bin1 = Threshold(bin, 1, INT_MAX);
  bin2 = ErodeBin(bin1, &S, radius);
  DestroyImage(&bin1);
  DestroySet(&S);
  return bin2;
}
